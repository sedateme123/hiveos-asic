#!/bin/sh


#
# Copyright (C) 2016-2020  Hiveon
# Distributed under GNU GENERAL PUBLIC LICENSE 2.0
# License information can be found in the LICENSE file or at https://github.com/minershive/hiveos-asic/blob/master/LICENSE.txt
#


export LD_LIBRARY_PATH="${LD_LIBRARY_PATH}${LD_LIBRARY_PATH:+:}/hive/lib"

if [ ! -e /hive ]; then
	ln -s /config/hive/hive/ /hive
	ln -s /config/hive/hive-config/ /hive-config
	ln -s /config/hive/home/root/.profile /home/root/.profile

	nohup /hive/sbin/bash -c 'sleep 30; /hive/bin/hive' > /tmp/client-boot.log 2>&1 &
	nohup /hive/sbin/bash -c 'sleep 60; /hive/bin/hello' > /tmp/delayed-hello.log 2>&1 & # backup hello (we've already got hello in /hive/bin/hive)

	# legacy cron imitation. commented out bc now it's a /hive/bin/controller built-in
	#nohup /hive/sbin/bash -c 'sleep 60; /hive/bin/cron1' > /dev/null 2>&1 &
	#nohup /hive/sbin/bash -c 'sleep 60; /hive/bin/cron2' > /dev/null 2>&1 &
fi
